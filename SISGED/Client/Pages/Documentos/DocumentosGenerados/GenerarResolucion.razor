@inject IJSRuntime js
@using SISGED.Client.Pages.Samples.WorkEnvironment
@using Newtonsoft.Json
<style>
    * {
        color: black;
    }

    .contenedor-PDF {
        height: 400px;
        width: 600px;
    }
</style>
<MatButton Raised="true" OnClick="@GenerarPDF"> Previsualizar Documento</MatButton>
<MatDialog @bind-IsOpen="@generado">
    <MatDialogTitle>Previsualizar Documento</MatDialogTitle>
    <MatDialogContent Class="contenedor-PDF">
        <iframe id="docpdf" style="background-color:#EEE; height:350px; width:500px"></iframe>
    </MatDialogContent>
</MatDialog>
<div style="display: none">
    <table id="convertirPDF">
        <tbody>
            <tr>
                <th colspan="7">@documento.titulo</th>
            </tr>
            <tr><td colspan="7"> </td></tr>
            <tr><td colspan="7"> Fecha de audiencia: </td></tr>
            <tr><td></td><td>- Inicio: @documento.fechainicioaudiencia.ToString("dd-MM-yy") </td><td></td><td></td><td></td><td></td><td></td></tr>
            <tr><td></td><td>- Fin: @documento.fechafinaudiencia.ToString("dd-MM-yy") </td><td></td><td></td><td></td><td></td><td></td></tr>
            <tr><td colspan="7">Descripción:</td></tr>
            <tr><td colspan="7">@documento.descripcion </td></tr>
            <tr><td colspan="7">Sanción:</td></tr>
            <tr><td colspan="7">@documento.sancion </td></tr>
            <tr><td colspan="7">Participantes:</td></tr>
            @foreach (string i in documento.participantes)
            {
                <tr><td></td><td>- @i </td><td></td><td></td><td></td><td></td><td></td></tr>
            }
        </tbody>
    </table>
</div>
@code {
    [CascadingParameter] WorkEnvironment workspace { get; set; }
    private ContenidoResolucion documento { get; set; }
    private bool generado = false;
    private async Task GenerarPDF()
    {
        generado = true;
        await js.InvokeVoidAsync("gPDF");
    }
    protected override void OnInitialized()
    {
        documento = JsonConvert.DeserializeObject<ContenidoResolucion>(workspace.expedienteseleccionado.documento.contenido.ToString());
        Console.WriteLine(documento.titulo);
    }
    //  doc.save('conversion.pdf');
    // await js.InvokeVoidAsync("gPDF");
}
