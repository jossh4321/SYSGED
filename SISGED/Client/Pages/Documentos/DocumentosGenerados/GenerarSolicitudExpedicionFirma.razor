@inject IJSRuntime js
@using SISGED.Client.Pages.Samples.WorkEnvironment
@using Newtonsoft.Json
<style>
    * {
        color: black;
    }

    .contenedor-PDF {
        height: 400px;
        width: 600px;
    }
</style>
<MatButton Raised="true" OnClick="@GenerarPDF"> Previsualizar Documento</MatButton>
<MatDialog @bind-IsOpen="@generado">
    <MatDialogTitle>Previsualizar Documento</MatDialogTitle>
    <MatDialogContent Class="contenedor-PDF">
        <iframe id="docpdf" style="background-color:#EEE; height:350px; width:500px"></iframe>
    </MatDialogContent>
</MatDialog>
<div style="display: none">
    <table id="convertirPDF">
        <tbody>
            <tr>
                <th colspan="7">@documento.titulo</th>
            </tr>
            <tr><td colspan="7"> </td></tr>
            <tr><td colspan="7">Código: @documento.codigo </td></tr>
            <tr><td colspan="7"> Fecha de entrega:  @documento.fecharealizacion.ToString("dd-MM-yy") </td></tr>
            <tr><td colspan="7"> Nombre del cliente: </td></tr>
            <tr><td colspan="7"> @documento.cliente</td></tr>
            <tr><td colspan="7">Descripción: </td></tr>
            <tr><td colspan="7"> @documento.descripcion</td></tr>
        </tbody>
    </table>
</div>
@code {
    [CascadingParameter] WorkEnvironment workspace { get; set; }
    private ContenidoSolicitudExpedicionFirma documento { get; set; }
    private bool generado = false;
    private async Task GenerarPDF()
    {
        generado = true;
        await js.InvokeVoidAsync("gPDF");
    }
    protected override void OnInitialized()
    {
        documento = JsonConvert.DeserializeObject<ContenidoSolicitudExpedicionFirma>(workspace.expedienteseleccionado.documento.contenido.ToString());
        Console.WriteLine(documento.titulo);
    }
    //  doc.save('conversion.pdf');
    // await js.InvokeVoidAsync("gPDF");
}
